# 安全密码管理器

一个安全的本地密码存储应用程序，具有加密功能和CSV导出选项。

## 特性

- 本地加密存储 - 所有数据都使用AES-256加密
- 安全密码保护 - 需要主密码才能访问
- CRUD操作 - 支持创建、读取、更新和删除密码
- CSV导出 - 一键导出所有密码到CSV文件
- 离线操作 - 不需要网络连接
- 6列数据结构 - 支持产品名称、账号、密码、邮箱、手机号、备注

## 安装

1. 克隆或下载项目文件
2. 安装依赖：
```bash
pip install -r requirements.txt
```

## 使用方式

本程序提供两种使用方式：
- **命令行版本** (`main.py`): 在终端中使用
- **Web版本** (`web_app.py`): 在浏览器中使用，界面更友好

## 使用方法

### 方式一：Web版本（推荐）

#### 启动Web应用

```bash
cd password_manager
python web_app.py
```

启动后，在浏览器中访问 http://127.0.0.1:5000

#### Web版本特性

- 🎨 美观的现代化界面
- 📱 响应式设计，支持各种设备
- 🔐 安全的登录认证
- ➕ 添加、查看、编辑、删除密码
- 📥 一键导出CSV
- 🔑 更改主密码

#### 登录Web版

1. 打开浏览器访问 http://127.0.0.1:5000
2. 输入主密码（首次使用请输入 `000000`）
3. 登录后可以更改主密码

### 方式二：命令行版本

#### 启动命令行程序

```bash
cd password_manager
python main.py
```

#### 首次使用设置主密码

首次运行程序时，系统会提示输入主密码：

```
请输入主密码以访问密码数据库：
主密码: 000000
```

初始密码为 `000000`，登录后可通过菜单更改。

### 修改主密码

启动程序后，选择菜单选项 **7. 更改主密码**：

```
--- 更改主密码 ---
请输入当前主密码:
请输入新主密码:
请再次输入新主密码:
```

输入当前主密码验证身份后，设置新主密码即可。

### 添加密码

#### 方式一：交互式菜单

启动程序后，选择菜单选项 **1. 添加密码**：

```
--- 添加新密码 ---
产品名称: Gmail
账号: user@gmail.com
密码:
邮箱 (可选，直接回车跳过): user@gmail.com
手机号 (可选，直接回车跳过): 13800138000
备注 (可选，直接回车跳过): 个人主要邮箱
密码添加成功！
```

**数据字段说明：**
- **产品名称** (必填): 作为唯一标识，如 Gmail、微信、支付宝等
- **账号** (必填): 登录账号，如邮箱、用户名等
- **密码** (必填): 账户密码
- **邮箱** (可选): 关联的邮箱地址
- **手机号** (可选): 关联的手机号码
- **备注** (可选): 其他说明信息

#### 方式二：命令行快速添加

```bash
# 基本用法（必填字段）
python main.py add <产品名称> <账号> <密码>

# 完整用法（所有字段）
python main.py add <产品名称> <账号> <密码> <邮箱> <手机号> <备注>

# 示例1：只填写必填项
python main.py add Gmail user@gmail.com mypassword123

# 示例2：填写所有信息
python main.py add Gmail user@gmail.com mypassword123 user@gmail.com 13800138000 "个人主要邮箱"
```

### 查看密码

启动程序后，选择菜单选项 **2. 查看密码**：

```
--- 查看密码 ---
请输入产品名称: Gmail

产品名称: Gmail
账号: user@gmail.com
密码: mypassword123
邮箱: user@gmail.com
手机号: 13800138000
备注: 个人主要邮箱
```

### 列出所有产品

启动程序后，选择菜单选项 **5. 列出所有产品**：

```
--- 所有产品 ---
产品列表:
1. Gmail
2. 微信
3. 支付宝
```

### 更新密码

启动程序后，选择菜单选项 **3. 更新密码**：

```
--- 更新密码 ---
请输入要更新的产品名称: Gmail
留空表示不更改该项
新账号 (留空则不变): newuser@gmail.com
新密码 (留空则不变):
新邮箱 (留空则不变):
新手机号 (留空则不变):
新备注 (留空则不变):
密码更新成功！
```

### 删除密码

启动程序后，选择菜单选项 **4. 删除密码**：

```
--- 删除密码 ---
请输入要删除的产品名称: Gmail
确认删除产品 'Gmail' 吗？(y/n): y
密码删除成功！
```

### 导出CSV文件

启动程序后，选择菜单选项 **6. 导出到CSV**：

```
--- 导出到CSV ---
请输入CSV文件保存路径 (例如: passwords.csv):
成功导出到CSV文件: passwords.csv
成功导出到: passwords.csv
```

如果不指定路径，默认导出为 `passwords.csv`。

导出的CSV文件格式如下：

```csv
产品名称,账号,密码,邮箱,手机号,备注
Gmail,user@gmail.com,mypassword123,user@gmail.com,13800138000,个人主要邮箱
微信,wx_user,wxpass123,,13900139000,工作微信
支付宝,user@alipay.com,alipay456,user@alipay.com,,
```

## 安全说明

- 请务必记住您的主密码，丢失后无法恢复数据
- 数据文件存储在 `data/passwords.enc`
- 加密使用PBKDF2密钥派生和AES-256加密
- 所有密码都安全存储，不会明文保存

## 功能列表

Web版和命令行版都支持以下功能：

1. 添加新密码
2. 查看密码
3. 更新密码
4. 删除密码
5. 列出所有产品
6. 导出到CSV文件
7. 更改主密码

推荐使用 **Web版本** (`web_app.py`)，操作更直观便捷。

## 文件结构

```
password_manager/
├── main.py              # 主应用程序（命令行版）
├── web_app.py           # Web应用程序（浏览器版）
├── encryptor.py         # 加密/解密模块
├── password_db.py       # 密码数据库管理
├── password_manager.py  # 密码管理CRUD操作
├── exporter.py          # CSV导出功能
├── requirements.txt     # 依赖包列表
├── templates/           # Web模板目录
│   ├── base.html
│   ├── login.html
│   ├── dashboard.html
│   ├── add_password.html
│   ├── view_password.html
│   ├── edit_password.html
│   └── change_password.html
└── data/                # 加密数据存储目录
    └── passwords.enc
```

## 注意事项

- 请将数据库文件备份到安全位置
- 定期更换主密码以提高安全性
- 在安全的环境中使用此应用程序
- 导出CSV后请及时安全处理文件（CSV文件为明文存储）
- 产品名称是唯一的，重复添加同一产品名称会失败


## docker使用方法

构建镜像：
```bash
docker build -t password-manager .
```

运行容器（**只允许本机访问**，带数据持久化）：
```bash
docker run -d \
  -p 127.0.0.1:5000:5000 \
  -v $(pwd)/data:/app/password_manager/data \
  --name password-manager \
  password-manager
```

**关键点**：`-p 127.0.0.1:5000:5000` 确保只有本机能访问，外部网络无法访问。

访问：http://localhost:5000 或 http://127.0.0.1:5000